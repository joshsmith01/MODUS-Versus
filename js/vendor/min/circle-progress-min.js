!function($){function t(t){this.init(t)}t.prototype={value:.5,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:!1,lineCap:"butt",constructor:t,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(t){$.extend(this,t),this.radius=this.size/2,this.initWidget(),this.initFill(),this.draw()},initWidget:function(){var t=this.canvas=this.canvas||$("<canvas>").prependTo(this.el)[0];t.width=this.size,t.height=this.size,this.ctx=t.getContext("2d")},initFill:function(){function t(){var t=$("<canvas>")[0];t.width=i.size,t.height=i.size,t.getContext("2d").drawImage(d,0,0,r,r),i.arcFill=i.ctx.createPattern(t,"no-repeat"),i.drawFrame(i.lastFrameValue)}var i=this,e=this.fill,a=this.ctx,r=this.size;if(!e)throw Error("The fill is not specified!");if(e.color&&(this.arcFill=e.color),e.gradient){var s=e.gradient;if(1==s.length)this.arcFill=s[0];else if(s.length>1){for(var n=e.gradientAngle||0,c=e.gradientDirection||[r/2*(1-Math.cos(n)),r/2*(1+Math.sin(n)),r/2*(1+Math.cos(n)),r/2*(1-Math.sin(n))],h=a.createLinearGradient.apply(a,c),l=0;l<s.length;l++){var o=s[l],g=l/(s.length-1);$.isArray(o)&&(g=o[1],o=o[0]),h.addColorStop(g,o)}this.arcFill=h}}if(e.image){var d;e.image instanceof Image?d=e.image:(d=new Image,d.src=e.image),d.complete?t():d.onload=t}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawFrame:function(t){this.lastFrameValue=t,this.ctx.clearRect(0,0,this.size,this.size),this.drawEmptyArc(t),this.drawArc(t)},drawArc:function(t){var i=this.ctx,e=this.radius,a=this.getThickness(),r=this.startAngle;i.save(),i.beginPath(),this.reverse?i.arc(e,e,e-a/2,r-2*Math.PI*t,r):i.arc(e,e,e-a/2,r,r+2*Math.PI*t),i.lineWidth=a,i.lineCap=this.lineCap,i.strokeStyle=this.arcFill,i.stroke(),i.restore()},drawEmptyArc:function(t){var i=this.ctx,e=this.radius,a=this.getThickness(),r=this.startAngle;1>t&&(i.save(),i.beginPath(),0>=t?i.arc(e,e,e-a/2,0,2*Math.PI):this.reverse?i.arc(e,e,e-a/2,r,r-2*Math.PI*t):i.arc(e,e,e-a/2,r+2*Math.PI*t,r),i.lineWidth=a,i.strokeStyle=this.emptyFill,i.stroke(),i.restore())},drawAnimated:function(t){var i=this,e=this.el;e.trigger("circle-animation-start"),$(this.canvas).stop(!0,!0).css({animationProgress:0}).animate({animationProgress:1},$.extend({},this.animation,{step:function(a){var r=i.animationStartValue*(1-a)+t*a;i.drawFrame(r),e.trigger("circle-animation-progress",[a,r])},complete:function(){e.trigger("circle-animation-end")}}))},getThickness:function(){return $.isNumeric(this.thickness)?this.thickness:this.size/14}},$.circleProgress={defaults:t.prototype},$.easing.circleProgressEasing=function(t,i,e,a,r){return(i/=r/2)<1?a/2*i*i*i+e:a/2*((i-=2)*i*i+2)+e},$.fn.circleProgress=function(i){var e="circle-progress";if("widget"==i){var a=this.data(e);return a&&a.canvas}return this.each(function(){var a=$(this),r=a.data(e),s=$.isPlainObject(i)?i:{};r?r.init(s):(s.el=a,r=new t(s),a.data(e,r))})}}(jQuery);